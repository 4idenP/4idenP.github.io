---
title: "Platypwn 2025 - Operation: Lost Data?"
subtitle: "Briefing: Agent: Agent P (a.k.a. Perry the Platypus) Subject: Recovered backup — suspected to belong to Dr. Heinz Doofenshmirtz Objective: Extract and analyze critical intelligence fragments before they self-destruct (metaphorically, we hope). During a recent OWCA operation, Agent P recovered a backup from a damaged device belonging to Dr. Heinz Doofenshmirtz. The phone itself is beyond repair, but traces of data remain. Analysis suggests Doofenshmirtz intentionally scattered three hidden fragments across different parts of his system. His final voice memo offers only riddles — a frozen memory, a restless idea, and in resting thoughts. Your task: extract all fragments before whatever he was planning comes to life."
excerpt: "Briefing: Agent: Agent P (a.k.a. Perry the Platypus) Subject: Recovered backup — suspected to belong to Dr. Heinz Doofenshmirtz Objective: Extract and analyze critical intelligence fragments before they self-destruct (metaphorically, we hope). During a recent OWCA operation, Agent P recovered a backup from a damaged device belonging to Dr. Heinz Doofenshmirtz. The phone itself is beyond repair, but traces of data remain. Analysis suggests Doofenshmirtz intentionally scattered three hidden fragments across different parts of his system. His final voice memo offers only riddles — a frozen memory, a restless idea, and in resting thoughts. Your task: extract all fragments before whatever he was planning comes to life."
date: 2025-11-16
categories: [forensics]
tags: [grep]
ctfs: [platypwn25]
author_profile: true
sidebar:
  nav: "docs"
header:
  overlay_color: "#000"
---

# Recon

We have an IPhone backup with all the data of the phone, let's dig in to find the 3 wanted flags.

# Investigations

## Flag 1

By looking for data mentioning file names, we encounter some results when looking for images : 

```
~# grep -rEaoi "[^/\\:*?\"<>|\r\n]+?\.(?:PNG|HEIC|JPG|GIF|BMP)" | sort -n | uniq | cut -d ":" -f 2
grep: warning: ? at start of expression
5005.JPG
DateMIMG_0001.HEIC
DateMIMG_0002.HEIC
IMG_0001.HEIC
IMG_0002.HEIC
_1x.jpg
_2x.jpg
_3x.jpg
#public.heic#   public.heic
100APPLEIMG_0001.HEIC
100APPLEIMG_0001.HEICDisplay P3public.heic
100APPLEIMG_0002.HEIC
100APPLEIMG_0002.HEICDisplay P3public.heic
19IMG_0001.HEIC
43IMG_0002.HEIC
_(b84cfd0e-c52b-4791-80c3-c1bce7fe9cfb.jpg
_(055efd52-b67a-445a-a9f5-fb35e192929f.jpg
$_(f1b70cdb-7fef-4665-8b2c-723f0b69321d.jpg
(_(7b049e23-f1f0-4563-b56f-bc7ac92e1bce.jpg
```

We have a bunch of different formats mentionned : *JPG*, *PNG* and *HEIC*. By looking for the following magic bytes : *PNG* and *JFIF* we don't find anything interesting, but when looking for *ftypheic*, the magic bytes for *HEIC* file format, we find two images with one of them containing the flag : 

```
~# grep -roa "ftypheic"
78/78564230ecf97df163e76713ce779e028c679bb6:ftypheic
3b/3b29365e0807a432d067f5792d8178dd1afbf764:ftypheic
```

> PP{b4ckup_l0c4l_ph0t0s_f0und}

The first flag is then located in a photo included in the backup.

- It was also possible to directly retrieve the images using *iLEAPP*, an open-source project that helps dig in iPhone backups by parsing plists and logs :
> [https://github.com/abrignoni/iLEAPP](https://github.com/abrignoni/iLEAPP)

## Flag 2

First of all, we *grep* using the *base64* encoding of the beginning of the flag : `PP{` which is `UFB7`, we find the second flag : 

```
~# grep -rEao "UFB7\w+\b" . | cut -d ":" -f 2 | sort -n | uniq
UFB7ZnIzM2Ywcm1fdDF0bDNfMW5fZDR0NGI0czN9
UFB7ZnIzM2Ywcm1fdDF0bDNfMW5fZDR0NGI0czN9EntityQueryDynamicOptionsProvider
UFB7ZnIzM2Ywcm1fdDF0bDNfMW5fZDR0NGI0czN9ZOpen
```

We got the *base64*-encoded flag : `UFB7ZnIzM2Ywcm1fdDF0bDNfMW5fZDR0NGI0czN9`

> PP{fr33f0rm_t1tl3_1n_d4t4b4s3}

The second flag comes from the *Freeform* application, a collaborative application. 

## Flag 3

Given the second flag was juste *base64*-encoded, let's try with the second most common : *base85*. We *grep* using the *base85* encoding of the beginning of the flag : `PP{` which is `:f)`, we find the third flag : 

```
~# grep -rEao ":f).*\b" . | sort -n | uniq 
./29/29159bc836191bb80372497839b77396a4d5702f::f)LL1Mejh1Lsj10Q]*l?SldZ?Z%ZC1NHi80Q&[pJ
./42/42b39453aaeb0a2774ff03132a660424355bf93f::f)LL1Mejh1Lsj10Q]*l?SldZ?Z%ZC1NHi80Q&[pJ
./4f/4f98687d8ab0d6d1a371110e6b7300f6e465bef2::f)LL1Mejh1Lsj10Q]*l?SldZ?Z%ZC1NHi80Q&[p
```

We got the *base85*-encoded flag : `:f)LL1Mejh1Lsj10Q]*l?SldZ?Z%ZC1NHi80Q&[p`

> PP{d3l3t3d_n0t3s_4r3_n3v3r_g0n3}

The third flag was located in a note.
